// This is a skeleton starter React component generated by Plasmic.
// This file is owned by you, feel free to edit as you see fit.
import React, { useState } from "react";
import {
  PlasmicDtInput,
  DefaultDtInputProps,
} from "./plasmic/easytime/PlasmicDtInput";
import { HTMLElementRefOf } from "@plasmicapp/react-web";
import { useInterval } from "../hooks/useInterval";
export type DTValues = {
  hour: string;
  minute: string;
  dayAgo: boolean;
};
interface DtInputProps extends DefaultDtInputProps {
  value: DTValues;
  onChange: (value: DTValues) => void;
}

function DtInput_(
  { value, onChange }: DtInputProps,
  ref: HTMLElementRefOf<"div">
) {
  const [isCustom, setCustom] = useState(false);
  useInterval(() => {
    if (!isCustom) {
      const now = new Date();
      onChange({
        hour: now.getHours().toString(),
        minute: now.getMinutes().toString(),
        dayAgo: false,
      });
    }
  }, 1000);
  return (
    <PlasmicDtInput
      root={{ ref }}
      type={isCustom ? "custom" : "now"}
      customTime={{
        value: value,
        onChange: (newVal) => {
          setCustom(true);
          onChange(newVal);
        },
      }}
      now={{
        onClick() {
          setCustom(false);
        },
      }}
      custom={{
        onClick() {
          setCustom(true);
        },
      }}
    />
  );
}

const DtInput = React.forwardRef(DtInput_);
export default DtInput;
